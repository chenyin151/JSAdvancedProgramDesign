<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>XMLHttpRequest对象</title>
</head>
<body>
    <script>
        // 创建兼容性较好的XHR对象
        function createXHR(){
            console.log('createXHR');
            debugger;
            if (typeof XMLHttpRequest != 'undefined') {
                return new XMLHttpRequest();
            } else if (typeof ActiveXObject != 'undefined') {
                if (typeof ActiveXObject != 'undefined') {
                    var versions = [ "MSXML2.XMLHttp.6.0", "MSXML2.XMLHttp.3.0", "MSXML2.XMLHttp"],
                    i, len;
                    for (i = 0,len=versions.length;i<len;i++){
                        try {
                            // new ActiveXObject(versions[i]);
                            arguments.callee.activeXString = versions[i];
                            break;
                        } catch(ex) {}
                    }
                }
                return new ActiveXObject(arguments.callee.activeXString);
            } else {
                throw new Error("No XHR object available");
            }
        }
        var xhr = new createXHR();
        xhr.open('POST', 'http://api.no1im.com/base/online/banner/list',false);
        xhr.send(null);//这次是一次同步请求
        if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {
            console.log(xhr.responseText);
        } else {
            console.log("Request was unsuccessful " + xhr.status);
        }
    </script>
</body>
</html>